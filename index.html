<!DOCTYPE html>

<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Uitgaven â€” Rob Borghouts</title>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,300;1,400&family=Space+Grotesk:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

:root {
â€“bg: #faf8f4;
â€“surface: #ffffff;
â€“card: #f5f2ed;
â€“border: #e8e2d9;
â€“ink: #1a1714;
â€“ink2: #4a4540;
â€“muted: #9a9088;
â€“accent: #c9602a;
â€“accent-light: #f5ebe3;
â€“green: #2a7a4f;
â€“green-light: #e3f0e9;
â€“blue: #2a5b8a;
â€“shadow: 0 2px 20px rgba(26,23,20,0.07);
â€“shadow-lg: 0 8px 40px rgba(26,23,20,0.12);
}

body {
font-family: â€˜Space Groteskâ€™, sans-serif;
background: var(â€“bg);
color: var(â€“ink);
min-height: 100vh;
padding: 0;
overflow-x: hidden;
}

.top-stripe {
height: 4px;
background: linear-gradient(90deg, #c9602a 0%, #e8a060 40%, #2a7a4f 70%, #2a5b8a 100%);
}

.page {
max-width: 820px;
margin: 0 auto;
padding: 3rem 1.5rem 5rem;
}

header {
margin-bottom: 3rem;
animation: riseUp 0.7s cubic-bezier(.16,1,.3,1) both;
border-bottom: 1px solid var(â€“border);
padding-bottom: 2rem;
display: flex;
align-items: flex-end;
justify-content: space-between;
gap: 1rem;
flex-wrap: wrap;
}

.header-left h1 {
font-family: â€˜Cormorant Garamondâ€™, serif;
font-size: clamp(3rem, 8vw, 5rem);
font-weight: 300;
line-height: 0.9;
letter-spacing: -0.03em;
color: var(â€“ink);
}

.header-left h1 em {
font-style: italic;
color: var(â€“accent);
}

.header-left .subtitle {
margin-top: 0.7rem;
font-size: 0.72rem;
text-transform: uppercase;
letter-spacing: 0.18em;
color: var(â€“muted);
font-weight: 500;
}

.header-date {
font-family: â€˜Cormorant Garamondâ€™, serif;
font-size: 0.95rem;
color: var(â€“muted);
font-style: italic;
text-align: right;
}

/* Summary */
.summary {
display: grid;
grid-template-columns: repeat(3, 1fr);
gap: 1.2rem;
margin-bottom: 2.5rem;
animation: riseUp 0.7s 0.08s cubic-bezier(.16,1,.3,1) both;
}

.summary-card {
background: var(â€“surface);
border: 1px solid var(â€“border);
border-radius: 16px;
padding: 1.5rem;
box-shadow: var(â€“shadow);
position: relative;
overflow: hidden;
transition: transform 0.2s, box-shadow 0.2s;
}

.summary-card:hover { transform: translateY(-2px); box-shadow: var(â€“shadow-lg); }

.summary-card::after {
content: â€˜â€™;
position: absolute;
top: 0; left: 0; right: 0;
height: 3px;
border-radius: 16px 16px 0 0;
}

.summary-card.s1::after { background: var(â€“accent); }
.summary-card.s2::after { background: var(â€“green); }
.summary-card.s3::after { background: var(â€“blue); }

.summary-card .label {
font-size: 0.65rem;
text-transform: uppercase;
letter-spacing: 0.14em;
color: var(â€“muted);
font-weight: 500;
margin-bottom: 0.6rem;
}

.summary-card .big-num {
font-family: â€˜Cormorant Garamondâ€™, serif;
font-size: 2rem;
font-weight: 300;
line-height: 1;
}

.summary-card.s1 .big-num { color: var(â€“accent); }
.summary-card.s2 .big-num { color: var(â€“green); }
.summary-card.s3 .big-num { color: var(â€“blue); }

.summary-card .sub-label {
font-size: 0.65rem;
color: var(â€“muted);
margin-top: 0.4rem;
}

/* Budget */
.budget-section {
background: var(â€“surface);
border: 1px solid var(â€“border);
border-radius: 16px;
padding: 1.5rem;
margin-bottom: 2rem;
box-shadow: var(â€“shadow);
animation: riseUp 0.7s 0.14s cubic-bezier(.16,1,.3,1) both;
}

.budget-header {
display: flex;
justify-content: space-between;
align-items: center;
margin-bottom: 1rem;
}

.budget-header .blabel {
font-size: 0.68rem;
text-transform: uppercase;
letter-spacing: 0.12em;
color: var(â€“muted);
font-weight: 500;
}

.budget-input-wrap {
display: flex;
align-items: center;
gap: 0.5rem;
}

.budget-input-wrap span { font-size: 0.75rem; color: var(â€“muted); }

.budget-input-wrap input {
width: 90px;
background: var(â€“card);
border: 1px solid var(â€“border);
border-radius: 8px;
color: var(â€“ink);
font-family: â€˜Space Groteskâ€™, sans-serif;
font-size: 0.82rem;
padding: 0.4rem 0.6rem;
outline: none;
transition: border-color 0.2s;
text-align: right;
}

.budget-input-wrap input:focus { border-color: var(â€“accent); }

.budget-track {
background: var(â€“card);
border-radius: 99px;
height: 8px;
overflow: hidden;
}

.budget-fill {
height: 100%;
border-radius: 99px;
background: linear-gradient(90deg, var(â€“green), #5dba88);
transition: width 0.6s cubic-bezier(.16,1,.3,1), background 0.4s;
min-width: 0px;
}

.budget-fill.warn { background: linear-gradient(90deg, #c9862a, #e8b060); }
.budget-fill.over { background: linear-gradient(90deg, #c9302a, #e85050); }

.budget-labels {
display: flex;
justify-content: space-between;
margin-top: 0.5rem;
font-size: 0.68rem;
color: var(â€“muted);
}

/* Chart */
.chart-section {
background: var(â€“surface);
border: 1px solid var(â€“border);
border-radius: 20px;
padding: 1.8rem;
margin-bottom: 2rem;
box-shadow: var(â€“shadow);
animation: riseUp 0.7s 0.2s cubic-bezier(.16,1,.3,1) both;
}

.section-title {
font-family: â€˜Cormorant Garamondâ€™, serif;
font-size: 1.5rem;
font-weight: 400;
margin-bottom: 1.2rem;
color: var(â€“ink);
}

.section-title em { font-style: italic; color: var(â€“accent); }

.chart-bars {
display: flex;
align-items: flex-end;
gap: 0.6rem;
height: 100px;
}

.chart-bar-wrap {
flex: 1;
display: flex;
flex-direction: column;
align-items: center;
gap: 0.35rem;
height: 100%;
justify-content: flex-end;
}

.chart-bar {
width: 100%;
border-radius: 6px 6px 0 0;
background: var(â€“accent-light);
border: 1px solid #e8d0c4;
transition: height 0.7s cubic-bezier(.16,1,.3,1);
min-height: 3px;
cursor: default;
}

.chart-bar:hover { background: var(â€“accent); }
.chart-bar.current { background: #e8a070; border-color: var(â€“accent); }

.chart-bar-label {
font-size: 0.6rem;
color: var(â€“muted);
text-transform: uppercase;
letter-spacing: 0.04em;
}

.chart-bar-val {
font-size: 0.58rem;
color: var(â€“muted);
}

/* Tip */
.tip-box {
background: linear-gradient(135deg, #f5ebe3 0%, #faf3ee 100%);
border: 1px solid #e8d0c4;
border-left: 3px solid var(â€“accent);
border-radius: 12px;
padding: 1rem 1.3rem;
margin-bottom: 2rem;
font-size: 0.8rem;
color: var(â€“ink2);
animation: riseUp 0.7s 0.25s cubic-bezier(.16,1,.3,1) both;
display: flex;
gap: 0.7rem;
align-items: flex-start;
line-height: 1.5;
}

.tip-box .tip-icon { font-size: 1rem; flex-shrink: 0; margin-top: 1px; }
.tip-box em { font-style: italic; font-weight: 500; color: var(â€“accent); }

/* Form */
.form-panel {
background: var(â€“surface);
border: 1px solid var(â€“border);
border-radius: 20px;
padding: 2rem;
margin-bottom: 2rem;
box-shadow: var(â€“shadow);
animation: riseUp 0.7s 0.3s cubic-bezier(.16,1,.3,1) both;
}

.form-grid {
display: grid;
grid-template-columns: 1fr 1fr;
gap: 1rem;
}

.form-group { display: flex; flex-direction: column; gap: 0.4rem; }
.form-group.full { grid-column: 1 / -1; }

label {
font-size: 0.65rem;
text-transform: uppercase;
letter-spacing: 0.12em;
color: var(â€“muted);
font-weight: 500;
}

input[type=text], input[type=number], input[type=date], select {
background: var(â€“card);
border: 1px solid var(â€“border);
border-radius: 10px;
color: var(â€“ink);
font-family: â€˜Space Groteskâ€™, sans-serif;
font-size: 0.88rem;
padding: 0.75rem 1rem;
outline: none;
transition: border-color 0.2s, background 0.2s;
width: 100%;
-webkit-appearance: none;
}

input:focus, select:focus { border-color: var(â€“accent); background: #fff; }

.add-btn {
width: 100%;
background: var(â€“ink);
color: #faf8f4;
border: none;
border-radius: 10px;
font-family: â€˜Space Groteskâ€™, sans-serif;
font-size: 0.82rem;
font-weight: 600;
padding: 0.9rem;
cursor: pointer;
letter-spacing: 0.08em;
text-transform: uppercase;
margin-top: 1.2rem;
transition: background 0.2s, transform 0.1s;
display: flex;
align-items: center;
justify-content: center;
gap: 0.5rem;
}

.add-btn:hover { background: var(â€“accent); }
.add-btn:active { transform: scale(0.99); }

/* Controls */
.controls {
display: flex;
justify-content: space-between;
align-items: center;
flex-wrap: wrap;
gap: 1rem;
margin-bottom: 1rem;
animation: riseUp 0.7s 0.34s cubic-bezier(.16,1,.3,1) both;
}

.filter-row {
display: flex;
gap: 0.5rem;
flex-wrap: wrap;
}

.filter-btn {
background: var(â€“surface);
border: 1px solid var(â€“border);
border-radius: 99px;
color: var(â€“ink2);
font-family: â€˜Space Groteskâ€™, sans-serif;
font-size: 0.7rem;
font-weight: 500;
padding: 0.35rem 0.85rem;
cursor: pointer;
transition: all 0.18s;
text-transform: uppercase;
letter-spacing: 0.05em;
}

.filter-btn:hover { border-color: var(â€“accent); color: var(â€“accent); }
.filter-btn.active { background: var(â€“ink); border-color: var(â€“ink); color: #faf8f4; }

.sort-select {
background: var(â€“surface);
border: 1px solid var(â€“border);
border-radius: 8px;
color: var(â€“ink2);
font-family: â€˜Space Groteskâ€™, sans-serif;
font-size: 0.7rem;
font-weight: 500;
padding: 0.38rem 0.8rem;
cursor: pointer;
outline: none;
transition: border-color 0.2s;
width: auto;
flex-shrink: 0;
}

.sort-select:focus { border-color: var(â€“accent); }

/* List */
.list-title {
font-family: â€˜Cormorant Garamondâ€™, serif;
font-size: 1.5rem;
font-weight: 400;
margin-bottom: 1rem;
color: var(â€“ink);
animation: riseUp 0.7s 0.34s cubic-bezier(.16,1,.3,1) both;
}

.expense-list {
display: flex;
flex-direction: column;
gap: 0.65rem;
animation: riseUp 0.7s 0.38s cubic-bezier(.16,1,.3,1) both;
}

.expense-item {
background: var(â€“surface);
border: 1px solid var(â€“border);
border-radius: 14px;
padding: 1rem 1.3rem;
display: grid;
grid-template-columns: 44px 1fr auto auto;
align-items: center;
gap: 1rem;
transition: box-shadow 0.2s, transform 0.2s;
}

.expense-item:hover {
box-shadow: var(â€“shadow);
transform: translateX(3px);
}

.cat-icon {
width: 44px;
height: 44px;
border-radius: 12px;
display: flex;
align-items: center;
justify-content: center;
font-size: 1.2rem;
flex-shrink: 0;
}

.expense-desc {
font-size: 0.9rem;
font-weight: 500;
color: var(â€“ink);
white-space: nowrap;
overflow: hidden;
text-overflow: ellipsis;
}

.expense-meta {
font-size: 0.65rem;
color: var(â€“muted);
margin-top: 0.2rem;
text-transform: uppercase;
letter-spacing: 0.05em;
}

.expense-amount {
font-family: â€˜Cormorant Garamondâ€™, serif;
font-size: 1.3rem;
font-weight: 600;
color: var(â€“accent);
white-space: nowrap;
}

.delete-btn {
background: none;
border: none;
color: var(â€“border);
cursor: pointer;
font-size: 0.85rem;
padding: 0.3rem;
border-radius: 6px;
transition: color 0.2s, background 0.2s;
line-height: 1;
}

.delete-btn:hover { color: #c9302a; background: #fdecea; }

/* Category icons bg */
.cat-eten          { background: #fff4e3; }
.cat-transport     { background: #e3eef8; }
.cat-wonen         { background: #f0e8f8; }
.cat-gezondheid    { background: #e3f4ec; }
.cat-entertainment { background: #fde8e3; }
.cat-kleding       { background: #fce8f0; }
.cat-abonnement    { background: #e8f0e3; }
.cat-sporten       { background: #e3f8f4; }
.cat-overig        { background: #f0f0f0; }

/* Empty state */
.empty-state {
text-align: center;
padding: 4rem 1rem;
color: var(â€“muted);
font-size: 0.8rem;
letter-spacing: 0.06em;
text-transform: uppercase;
}

.empty-state .icon { font-size: 3rem; margin-bottom: 1rem; display: block; opacity: 0.4; }

/* Footer */
footer {
text-align: center;
padding-top: 3rem;
border-top: 1px solid var(â€“border);
margin-top: 3rem;
}

.made-by {
font-family: â€˜Cormorant Garamondâ€™, serif;
font-size: 1.1rem;
font-style: italic;
color: var(â€“muted);
}

.made-by strong { font-weight: 600; color: var(â€“ink); font-style: normal; }

.version {
font-size: 0.62rem;
text-transform: uppercase;
letter-spacing: 0.12em;
color: var(â€“border);
margin-top: 0.5rem;
}

/* Toast */
.toast {
position: fixed;
bottom: 2rem;
right: 2rem;
background: var(â€“ink);
color: #faf8f4;
font-size: 0.8rem;
font-weight: 500;
padding: 0.7rem 1.3rem;
border-radius: 10px;
box-shadow: var(â€“shadow-lg);
opacity: 0;
transform: translateY(10px);
transition: all 0.3s;
pointer-events: none;
z-index: 99;
}

.toast.show { opacity: 1; transform: translateY(0); }

@keyframes riseUp {
from { opacity: 0; transform: translateY(18px); }
to   { opacity: 1; transform: translateY(0); }
}

@media (max-width: 560px) {
.summary { grid-template-columns: 1fr 1fr; }
.summary .s3 { grid-column: 1 / -1; }
.form-grid { grid-template-columns: 1fr; }
.expense-item { grid-template-columns: 40px 1fr auto auto; gap: 0.7rem; }
.controls { flex-direction: column; align-items: flex-start; }
}
</style>

</head>
<body>
<div class="top-stripe"></div>
<div class="page">

  <header>
    <div class="header-left">
      <h1>Mijn <em>Uitgaven</em></h1>
      <div class="subtitle">Persoonlijk financieel overzicht</div>
    </div>
    <div class="header-date" id="header-date"></div>
  </header>

  <!-- Summary -->

  <div class="summary">
    <div class="summary-card s1">
      <div class="label">Totaal ooit</div>
      <div class="big-num" id="total-amount">â‚¬ 0</div>
      <div class="sub-label" id="total-count">0 uitgaven</div>
    </div>
    <div class="summary-card s2">
      <div class="label">Deze maand</div>
      <div class="big-num" id="month-amount">â‚¬ 0</div>
      <div class="sub-label" id="month-count">0 uitgaven</div>
    </div>
    <div class="summary-card s3">
      <div class="label">Gem. per dag</div>
      <div class="big-num" id="avg-amount">â‚¬ 0</div>
      <div class="sub-label">gebaseerd op deze maand</div>
    </div>
  </div>

  <!-- Budget -->

  <div class="budget-section">
    <div class="budget-header">
      <div class="blabel">Maandbudget instellen</div>
      <div class="budget-input-wrap">
        <span>â‚¬</span>
        <input type="number" id="budget-input" placeholder="1500" min="0" step="50" oninput="updateBudget()" />
      </div>
    </div>
    <div class="budget-track">
      <div class="budget-fill" id="budget-fill" style="width:0%"></div>
    </div>
    <div class="budget-labels">
      <span id="budget-spent">â‚¬ 0,00 uitgegeven</span>
      <span id="budget-left">Stel een budget in â†’</span>
    </div>
  </div>

  <!-- Chart -->

  <div class="chart-section">
    <div class="section-title">Afgelopen <em>6 maanden</em></div>
    <div class="chart-bars" id="chart-bars"></div>
  </div>

  <!-- Tip -->

  <div class="tip-box">
    <div class="tip-icon">ğŸ’¡</div>
    <div id="tip-text"></div>
  </div>

  <!-- Form -->

  <div class="form-panel">
    <div class="section-title">Nieuwe <em>uitgave</em> toevoegen</div>
    <div class="form-grid">
      <div class="form-group full">
        <label>Omschrijving</label>
        <input type="text" id="desc" placeholder="Bijv. Albert Heijn boodschappenâ€¦" />
      </div>
      <div class="form-group">
        <label>Bedrag (â‚¬)</label>
        <input type="number" id="amount" placeholder="0,00" step="0.01" min="0" />
      </div>
      <div class="form-group">
        <label>Categorie</label>
        <select id="category">
          <option value="eten">ğŸ” Eten & drinken</option>
          <option value="transport">ğŸš— Transport</option>
          <option value="wonen">ğŸ  Wonen</option>
          <option value="gezondheid">ğŸ’Š Gezondheid</option>
          <option value="entertainment">ğŸ¬ Entertainment</option>
          <option value="kleding">ğŸ‘— Kleding</option>
          <option value="abonnement">ğŸ“± Abonnementen</option>
          <option value="sporten">ğŸƒ Sporten</option>
          <option value="overig">ğŸ“¦ Overig</option>
        </select>
      </div>
      <div class="form-group">
        <label>Datum</label>
        <input type="date" id="date" />
      </div>
      <div class="form-group full">
        <label>Notitie (optioneel)</label>
        <input type="text" id="note" placeholder="Extra toelichtingâ€¦" />
      </div>
    </div>
    <button class="add-btn" onclick="addExpense()">ï¼‹ &nbsp;Uitgave toevoegen</button>
  </div>

  <!-- Controls -->

  <div class="controls">
    <div class="filter-row" id="filter-row"></div>
    <select class="sort-select" id="sort-select" onchange="render()">
      <option value="date-desc">Nieuwste eerst</option>
      <option value="date-asc">Oudste eerst</option>
      <option value="amount-desc">Hoogste bedrag</option>
      <option value="amount-asc">Laagste bedrag</option>
    </select>
  </div>

  <div class="list-title">Overzicht</div>
  <div class="expense-list" id="expense-list"></div>

  <footer>
    <div class="made-by">Gemaakt door <strong>Rob Borghouts</strong></div>
    <div class="version">Uitgaven Tracker v2.0 &middot; Persoonlijk gebruik</div>
  </footer>
</div>

<div class="toast" id="toast"></div>

<script>
const CATS = {
  eten:          { label: 'Eten & drinken',  icon: 'ğŸ”' },
  transport:     { label: 'Transport',        icon: 'ğŸš—' },
  wonen:         { label: 'Wonen',            icon: 'ğŸ ' },
  gezondheid:    { label: 'Gezondheid',       icon: 'ğŸ’Š' },
  entertainment: { label: 'Entertainment',    icon: 'ğŸ¬' },
  kleding:       { label: 'Kleding',          icon: 'ğŸ‘—' },
  abonnement:    { label: 'Abonnementen',     icon: 'ğŸ“±' },
  sporten:       { label: 'Sporten',          icon: 'ğŸƒ' },
  overig:        { label: 'Overig',           icon: 'ğŸ“¦' },
};

const TIPS = [
  "De <em>50/30/20 regel</em>: besteed 50% aan vaste lasten, 30% aan wensen en 20% aan sparen.",
  "Kleine dagelijkse uitgaven tellen snel op â€” een dagelijkse koffie van â‚¬3,50 kost je <em>â‚¬1.277 per jaar</em>.",
  "Bekijk maandelijks je abonnementen â€” gemiddeld heeft iemand <em>2â€“3 vergeten abonnementen</em> lopen.",
  "Boodschappen zonder lijst kosten gemiddeld <em>23% meer</em>. Altijd een lijst meenemen!",
  "De beste besparing zit vaak in <em>energie en verzekeringen</em>. Vergelijken loont altijd.",
  "Betaal jezelf eerst: zet op de 1e van de maand direct een vast bedrag opzij voor sparen.",
  "Gebruik de <em>notitie-optie</em> om extra context toe te voegen aan je uitgaven.",
];

let expenses = JSON.parse(localStorage.getItem('rb_uitgaven_v2') || '[]');
let budget = parseFloat(localStorage.getItem('rb_budget_v2') || '0');
let activeFilter = 'alles';

document.getElementById('date').value = new Date().toISOString().split('T')[0];
document.getElementById('budget-input').value = budget || '';
document.getElementById('header-date').textContent = new Date().toLocaleDateString('nl-NL', { weekday:'long', day:'numeric', month:'long', year:'numeric' });
document.getElementById('tip-text').innerHTML = TIPS[Math.floor(Math.random() * TIPS.length)];

function save() {
  localStorage.setItem('rb_uitgaven_v2', JSON.stringify(expenses));
  localStorage.setItem('rb_budget_v2', budget.toString());
}

function fmt(n) {
  return 'â‚¬\u00a0' + n.toFixed(2).replace('.', ',').replace(/\B(?=(\d{3})+(?!\d))/g, '.');
}

function fmtDate(d) {
  return new Date(d + 'T12:00:00').toLocaleDateString('nl-NL', { day:'numeric', month:'short', year:'numeric' });
}

function toast(msg) {
  const el = document.getElementById('toast');
  el.textContent = msg;
  el.classList.add('show');
  setTimeout(() => el.classList.remove('show'), 2400);
}

function addExpense() {
  const desc   = document.getElementById('desc').value.trim();
  const amount = parseFloat(document.getElementById('amount').value);
  const cat    = document.getElementById('category').value;
  const date   = document.getElementById('date').value;
  const note   = document.getElementById('note').value.trim();

  if (!desc || isNaN(amount) || amount <= 0 || !date) {
    toast('âš ï¸ Vul omschrijving, bedrag en datum in.');
    return;
  }

  expenses.unshift({ id: Date.now(), desc, amount, category: cat, date, note });
  save();
  render();
  toast('âœ“ Uitgave toegevoegd!');

  document.getElementById('desc').value   = '';
  document.getElementById('amount').value = '';
  document.getElementById('note').value   = '';
  document.getElementById('date').value   = new Date().toISOString().split('T')[0];
}

function deleteExpense(id) {
  expenses = expenses.filter(e => e.id !== id);
  save();
  render();
  toast('ğŸ—‘ Uitgave verwijderd.');
}

function updateBudget() {
  budget = parseFloat(document.getElementById('budget-input').value) || 0;
  save();
  renderBudget();
}

function getMonthExpenses() {
  const now = new Date();
  return expenses.filter(e => {
    const d = new Date(e.date + 'T12:00:00');
    return d.getMonth() === now.getMonth() && d.getFullYear() === now.getFullYear();
  });
}

function renderBudget() {
  const monthTotal = getMonthExpenses().reduce((s, e) => s + e.amount, 0);
  const fill  = document.getElementById('budget-fill');
  const spent = document.getElementById('budget-spent');
  const left  = document.getElementById('budget-left');

  spent.textContent = fmt(monthTotal) + ' uitgegeven';

  if (!budget) {
    fill.style.width = '0%';
    left.textContent = 'Stel een budget in â†’';
    fill.className = 'budget-fill';
    return;
  }

  const pct = Math.min((monthTotal / budget) * 100, 100);
  fill.style.width = pct + '%';
  fill.className = 'budget-fill' + (pct >= 100 ? ' over' : pct >= 75 ? ' warn' : '');

  const remaining = budget - monthTotal;
  left.textContent = remaining <= 0
    ? 'ğŸ”´ ' + fmt(Math.abs(remaining)) + ' over budget'
    : fmt(remaining) + ' resterend';
}

function renderChart() {
  const now = new Date();
  const months = [];
  for (let i = 5; i >= 0; i--) {
    const d = new Date(now.getFullYear(), now.getMonth() - i, 1);
    months.push({ m: d.getMonth(), y: d.getFullYear(), label: d.toLocaleDateString('nl-NL', { month:'short' }), current: i === 0 });
  }

  const totals = months.map(mo =>
    expenses.filter(e => {
      const d = new Date(e.date + 'T12:00:00');
      return d.getMonth() === mo.m && d.getFullYear() === mo.y;
    }).reduce((s, e) => s + e.amount, 0)
  );

  const max = Math.max(...totals, 1);
  document.getElementById('chart-bars').innerHTML = months.map((mo, i) => `
    <div class="chart-bar-wrap">
      <div class="chart-bar-val">${totals[i] > 0 ? 'â‚¬' + Math.round(totals[i]) : ''}</div>
      <div class="chart-bar${mo.current ? ' current' : ''}" style="height:${Math.max((totals[i] / max) * 80, 3)}px" title="${fmt(totals[i])}"></div>
      <div class="chart-bar-label">${mo.label}</div>
    </div>
  `).join('');
}

function renderFilters() {
  const cats = ['alles', ...Object.keys(CATS)];
  document.getElementById('filter-row').innerHTML = cats.map(c => `
    <button class="filter-btn ${c === activeFilter ? 'active' : ''}" onclick="setFilter('${c}', this)">
      ${c === 'alles' ? 'Alles' : CATS[c].icon + ' ' + CATS[c].label}
    </button>
  `).join('');
}

function setFilter(cat, btn) {
  activeFilter = cat;
  document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  renderList();
}

function renderList() {
  let list = activeFilter === 'alles' ? [...expenses] : expenses.filter(e => e.category === activeFilter);

  const sort = document.getElementById('sort-select').value;
  if      (sort === 'date-desc')   list.sort((a,b) => b.date.localeCompare(a.date) || b.id - a.id);
  else if (sort === 'date-asc')    list.sort((a,b) => a.date.localeCompare(b.date) || a.id - b.id);
  else if (sort === 'amount-desc') list.sort((a,b) => b.amount - a.amount);
  else if (sort === 'amount-asc')  list.sort((a,b) => a.amount - b.amount);

  const container = document.getElementById('expense-list');

  if (list.length === 0) {
    container.innerHTML = `<div class="empty-state"><span class="icon">ğŸ“­</span>${activeFilter === 'alles' ? 'Nog geen uitgaven geregistreerd' : 'Geen uitgaven in deze categorie'}</div>`;
    return;
  }

  container.innerHTML = list.map((e, idx) => `
    <div class="expense-item" style="animation: riseUp 0.3s ${idx*0.03}s ease both">
      <div class="cat-icon cat-${e.category}">${CATS[e.category]?.icon || 'ğŸ“¦'}</div>
      <div>
        <div class="expense-desc">${e.desc}</div>
        <div class="expense-meta">${CATS[e.category]?.label || 'Overig'} &middot; ${fmtDate(e.date)}${e.note ? ' &middot; ' + e.note : ''}</div>
      </div>
      <div class="expense-amount">${fmt(e.amount)}</div>
      <button class="delete-btn" onclick="deleteExpense(${e.id})" title="Verwijderen">âœ•</button>
    </div>
  `).join('');
}

function renderSummary() {
  const total = expenses.reduce((s,e) => s + e.amount, 0);
  const me = getMonthExpenses();
  const monthTotal = me.reduce((s,e) => s + e.amount, 0);
  const avg = monthTotal / (new Date().getDate() || 1);

  document.getElementById('total-amount').textContent = fmt(total);
  document.getElementById('month-amount').textContent = fmt(monthTotal);
  document.getElementById('avg-amount').textContent   = fmt(avg);
  document.getElementById('total-count').textContent  = expenses.length + ' uitgaven';
  document.getElementById('month-count').textContent  = me.length + ' deze maand';
}

function render() {
  renderSummary();
  renderBudget();
  renderChart();
  renderFilters();
  renderList();
}

render();
</script>

</body>
</html>